<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flashcard Generator</title>
</head>
<body>
  <h1>Flashcard Generator</h1>
  <textarea id="inputText" rows="10" cols="80" placeholder="Enter your text here..."></textarea><br>
  <button onclick="generateFlashcardsFromInput()">Generate Flashcards</button>

  <h2>Generated Flashcards</h2>
  <div id="flashcardsOutput"></div>

  <script>
    function generateFlashcardsFromInput() {
      const inputText = document.getElementById("inputText").value;
      const flashcards = generateFlashcards(inputText);
      displayFlashcards(flashcards);
    }

    function generateFlashcards(text) {
      // Regular expression to match cloze deletions (e.g., {{c1::...}})
      const clozeRegex = /\{\{c\d+::(.*?)\}\}/g;

      // Split the input text by new lines to handle each line separately
      const sentences = text.split('\n');

      let allFlashcards = [];

      sentences.forEach(sentence => {
        const clozeMatches = [];
        let match;
        // Find all cloze deletions in the current sentence
        while ((match = clozeRegex.exec(sentence)) !== null) {
          clozeMatches.push(match);
        }

        if (clozeMatches.length > 0) {
          // For each cloze match, create a flashcard
          clozeMatches.forEach(match => {
            const clozeValue = match[1];  // The value inside the cloze deletion (the part to be hidden)
            
            // Create the question by replacing just this cloze deletion with a blank
            let question = sentence.replace(match[0], '_______');
            
            // Add the flashcard: The sentence with the blank, and the answer (cloze value only)
            allFlashcards.push({
              question: question,  // Question with only one blank
              answer: clozeValue   // Answer is the cloze value
            });
          });
        }
      });

      return allFlashcards;
    }

    function displayFlashcards(flashcards) {
      const outputDiv = document.getElementById("flashcardsOutput");
      outputDiv.innerHTML = ''; // Clear any previous output

      if (flashcards.length === 0) {
        outputDiv.innerHTML = "<p>No flashcards generated. Make sure your input contains cloze deletions (e.g., {{c1::...}}).</p>";
      } else {
        flashcards.forEach(card => {
          const cardDiv = document.createElement("div");

          // Display the question and answer
          cardDiv.innerHTML = `<p><strong>Question:</strong> ${card.question}</p>`;
          cardDiv.innerHTML += `<p><strong>Answer:</strong> ${card.answer}</p>`;

          outputDiv.appendChild(cardDiv);
        });
      }
    }
  </script>
</body>
</html>
